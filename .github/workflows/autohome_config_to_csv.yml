name: autohome_config_to_csv

on:
  workflow_dispatch:  # 必要なら schedule にも対応可

jobs:
  extract_config_csv:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install Playwright
        run: |
          python -m pip install --upgrade pip
          pip install playwright
          python -m playwright install chromium

      - name: Run extractor (PC site)
        run: |
          python tools/autohome_config_to_csv.py \
            --series 7578 \
            --outdir output/autohome

      # もしPCで有効テーブルがゼロ等なら、コメントアウトを外してモバイル版も試してOK
      # - name: Run extractor (Mobile site fallback)
      #   run: |
      #     python tools/autohome_config_to_csv.py \
      #       --series 7578 \
      #       --outdir output/autohome \
      #       --mobile

      - name: Upload CSV artifacts
        uses: actions/upload-artifact@v4
        with:
          name: autohome_config_7578_csv
          path: output/autohome/7578/*.csv
